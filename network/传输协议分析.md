  - [传输协议分析](#传输协议分析)
    - [1.RTMP协议分析](#1rtmp协议分析)
      - [1.1 RTMP协议介绍](#11-rtmp协议介绍)
      - [1.2 RTMP为什么还要建连](#12-rtmp为什么还要建连)
      - [1.3 RTMP建连流程](#13-rtmp建连流程)
    - [2.HTTP2.0协议分析](#2http20协议分析)
      - [2.1 优化的多路复用](#21-优化的多路复用)
      - [2.2 二进制分帧](#22-二进制分帧)
      - [2.3 头部压缩](#23-头部压缩)
      - [2.4 服务器推送](#24-服务器推送)
    - [3.QUIC协议分析](#3quic协议分析)
      - [3.1 链接耗时更短](#31-链接耗时更短)
      - [3.2 拥塞控制更出色](#32-拥塞控制更出色)
      - [3.3 s更好的多路复用](#33-s更好的多路复用)
      - [3.4 前向纠错特性](#34-前向纠错特性)
      - [3.5 链接迁移特性](#35-链接迁移特性)

## 传输协议分析
### 1.RTMP协议分析
#### 1.1 RTMP协议介绍
RTMP协议是应用层协议，是要靠底层可靠的传输层（TCP），
协议（通常是TCP）来保证信息传输的可靠性的。在基于传输层协议的链接建立完成后，RTMP协议也要客户端和服务器通过“握手”来建立基于传输层链接之上的RTMP Connection链接。播放一个RTMP协议的流媒体需要经过以下几个步骤：握手，建立网络连接，建立网络流，播放。服务器和客户端之间只能建立一个网络连接，但是基于该连接可以创建很多网络流。
#### 1.2 RTMP为什么还要建连
这儿埋下一个小疑问？为什么传输层已经建立了TCP连接，RTMP还需要再次建立一个连接，有这个必要吗？

RTMP协议传输时会对数据做自己的格式化，这种格式的消息我们称之为RTMP Message，而实际传输的时候为了更好地实现多路复用、分包和信息的公平性，发送端会把Message划分为带有Message ID的Chunk，每个Chunk可能是一个单独的Message，也可能是Message的一部分，在接受端会根据chunk中包含的data的长度，message id和message的长度把chunk还原成完整的Message，从而实现信息的收发。

因为它们需要商量一些事情，保证以后的传输能正常进行。主要就是两个事情，一个是版本号，如果客户端、服务器的版本号不一致，则不能工作。另一个就是时间戳，视频播放中，时间是很重要的，后面的数据流互通的时候，经常要带上时间戳的差值，因而一开始双方就要知道对方的时间戳。


#### 1.3 RTMP建连流程
> * RTMP握手
> * 拉流
> * 播放

RTMP握手流程:
> * 客户端发送 C0、C1、 C2，服务器发送 S0、 S1、 S2。
> * 首先，客户端发送 C0 表示自己的版本号，不必等对方的回复，然后发送 C1 表示自己的时间戳。
> * 服务器只有在收到 C0 的时候，才能返回 S0，表明自己的版本号，如果版本不匹配，可以断开连接。
> * 服务器发送完 S0 后，也不用等什么，就直接发送自己的时间戳 S1。客户端收到 S1 的时候，发一个知道了对方时间戳的 ACK C2。同理服务器收到 C1 的时候，发一个知道了对方时间戳的 ACK S2。
> * 握手建立完成。

RTMP拉流流程:
> * 建立网络连接---> Connect
> * 创建网络流---> Create Stream
> * 播放---> Play

****

### 2.HTTP2.0协议分析
#### 2.1 优化的多路复用
多路复用允许同时通过单一的 HTTP/2 连接发起多重的请求-响应消息，
在HTTP1.1中，浏览器客户端针对同一个域名下的请求有数量限制，超过限制数目的请求会被阻塞。
#### 2.2 二进制分帧
HTTP1.1是纯文本的传输，HTTP2.0是数据帧的传输，信息会被压缩成数据帧，然后分为多个帧分别传输，传输到对端之后再组装帧，这样可以大大减少传输的延迟，提升了传输的性能。
#### 2.3 头部压缩
HTTP2.0使用HPACK头部压缩方法压缩头部。这样减少传输的数据量。
#### 2.4 服务器推送
服务端推送是一种在客户端请求之前发送数据的机制。在 HTTP/2 中，服务器可以对客户端的一个请求发送多个响应。

****

### 3.QUIC协议分析
#### 3.1 链接耗时更短
#### 3.2 拥塞控制更出色
无论HTTP2(HTTP/2 over TCP)、HTTP1.x协议还是SPDY协议都基于TCP协议，上层可以解决HOL问题，但是传输层的HOL依然存在。说起传输层TCP协议的队头阻塞，这要从TCP的流量控制策略说起了。
#### 3.3 s更好的多路复用
#### 3.4 前向纠错特性
#### 3.5 链接迁移特性
